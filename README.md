# Face-Recognition-and-Detection


人脸识别与检测。
含数据集和源代码。


这个人脸识别一共包含6个文件。


1. get_my_faces.py调用摄像头获取使用者的人脸图片，作为数据储存到my_faces文件夹中去。最终就是要从众多人脸图片中，识别出使用者。


2. set_other_faces.py从人脸数据集中获取图片，对其进行预处理，之后存入other_faces文件夹中去。


3. Functions.py存储的是处理图片数据时用到的函数，包括getPaddingSize()和readData()。

  预处理图片的时候，需要对其周围进行padding，调用函数getPaddingSize()可以得到，对于一张图片，上下左右分别需要补充多少行或者多少列。

  函数readData()从文件夹my_faces和other_faces中读取数据图片，并对其进行padding，之后添加到imgs列表中去；并根据图片所在文件夹给图片赋予标签，添加   到labs列表中去。之后

  就从imgs和labs中分离出训练数据和测试数据来训练网络。


4. Blocks.py存储的是搭建卷积神经网络用到的模块，包括一个卷积模块、一个全连接模块、一个输出模块。

  卷积模块包括卷积层、ReLU层、池化层、drop层。

  全连接模块包括全连接层和drop层。

  输出模块包括一个全连接层。


5. TrainCNN.py读取数据，搭建卷积神经网络，并训练它。

  调用函数readData()读取数据，并存储到列表imgs和labs中。

  随机划分训练集（train_x, train_y）和测试集（test_x, test_y）。

  把图片归一化。

  打印训练集和测试集的大小。

  给出批的大小，以及相应的完整地把训练集训练完一次需要的代数，即一个epoch包含的代数。

  占位符，x和y_分别用于图片和标签输入到网络。

  keep_prob_5与keep_prob_75是与drop层相关的参数占位符。

  卷积神经网络的搭建用到了Blocks中的模块。这里的网络包含三个卷积模块、一个全连接模块、一个输出模块。

  定义损失函数、优化器、准确率。

  之后开始训练，每批训练数据按顺序依次从训练集（train_x, train_y）中取出，每代打印损失函数，每100代打印准确率，计算准确率的数据从测试集（test_x, test_y）中获得。

  当达到规定的epoch数量或者连续10次出现的准确率均大于0.99时，退出训练。


6. TestCNN.py测试训练好的网络。

  使用OpenCV调用摄像头，获取图像，检测到当前人脸，标记矩形框，并使用训练好的网络判断当前人脸是否为训练时给的使用者人脸。





